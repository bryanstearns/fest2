<% content_for :header do %>
  <% round_corners :width => "100%" do |rc| %>
    <% if conference_mode %>
      <h2>Get more out of your conference experience</h2>
      <ul style="margin: 0px; padding-bottom: 10px;">
        <li>Keep track of the sessions you really want to attend</li>
      </ul>
    <% else %>
      <h2>Get more out of your film festival experience!</h2>
      It's as easy as 1 - 2 - 3:
      <ol style="margin: 0px; padding-bottom: 10px;">
        <li>Prioritize films</li>
        <li>Tell us when you're available, and we'll find screenings for you automatically</li>
        <li>Browse your schedule (soon: on your smartphone, too)</li>
      </ol>
      <% unless logged_in? %>
      <%= link_to "Sign up", signup_url %> or <%= link_to "Log in", login_url %> to get started!
      <% end %>
    <% end %>
  <% end %>
<% end %>

<noscript>
  <blockquote style="border: 1px solid red; padding: 4px">
  <h3>Uh-oh: Your browser doesn't like us!</h3>    
  <p>Your browser doesn't support Javascript (or you've turned it off), and most of this site won't work right without it. <%= link_to "Send us feedback", feedback_path %> - this will influence us to implement the Javascript-free support sooner.</p>
  </blockquote>
</noscript>

<% amazon_choices = render_random_subset_with_caching(@controller, 
                      @amazon_films, @amazon_limit, "films/amazon", 
                      @amazon_cache_key) %>
<% unless amazon_choices.empty? %>
<div class="ad_section">
  <iframe src="http://rcm.amazon.com/e/cm?t=festivalfcom-20&o=1&p=20&l=ur1&category=dvd&banner=130ZQ0QAXHY8DR8Z9GR2&f=ifr" width="120" height="90" scrolling="no" border="0" marginwidth="0" style="border:none;" frameborder="0"></iframe>
  These festival films are available on DVD from Amazon:
  <ul>
  <%= amazon_choices.join("\n") %>
  </ul>
</div>
<% end %>

<% cache @festivals_cache_key do %>
<div class="festival_section">
  <% 
  today = Date.today
  have_old = false
  show_festivals = []
  @festivals.each do |f|
    if f.ends < today
      have_old = true
    else
      show_festivals << f
    end
  end
  if show_festivals.empty? %>
  <p>More <%= _[:festivals] %> coming soon -- if you're interested in one in particular, tell us about it on the feedback page.</p>
    <% if have_old %>
    <ul><li><%= link_to "Click here", festivals_url %> to see past <%= _[:festivals] %></li></ul>
    <% end %>
  <% else %>
  <h3>Click an upcoming <%= _[:festival] %>:</h3>
  <ul id="upcomingfestivals">
  <%= render :partial => 'festivals/festival', :collection => show_festivals.sort_by {|f| f.starts } %>
    <% if have_old %>
  <li><%= link_to "Click here", festivals_url %> to see past <%= _[:festivals] %></li>
    <% end %>
  </ul>
  <% end %>
</div>      
<% end %>

<% cache @announcements_cache_key do %>
  <% unless @announcements.empty? %>
<div class="news_section">
  <h3>News <%= link_to icon_tag("feed", :style=>"border: none"), formatted_announcements_url(:rss) %></h3>
  <ul class="announcements">
    <%= render :partial => 'announcements/announcement', :collection => @announcements,
               :locals => { :announcement_limit => @announcement_limit } %>
  </ul>
</div>
  <% end %>
<% end %>

<div id="copyright">
  Copyright &copy; 2007-2009 The Thomas Eliot Company; all rights reserved.
</div>

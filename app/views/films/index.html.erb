<%# The public list of all films in a festival -%>
<% content_for :title do %>Films at <%= @festival.name %><% end %>
<% content_for :header do %>
  <%= render :partial => "festivals/header", :locals => { :festival => @festival, :hide_tabs => false } %>
<% end %>

<% if logged_in? %>
<p>Here are all the films in the festival. You can indicate your preference for seeing each film by clicking one of the
little circles next to each film: the rightmost means "<%= ranking_hints[4] %>," 
and the leftmost means "<%= ranking_hints[0] %>."</p>

<p>Each preference is saved as soon as you click; you can come back later if 
you don't finish now.</p>

<p style="display:inline">When you've finished prioritizing your films, click this button: 
<%= button_to "Schedule Automatically", 
              poly_schedule_festival_url(@festival),
              :id => "schedule_button" %>
to automatically schedule screenings for as 
many of your films as possible. 
(You can also reset all your priorities and start over
by clicking <%= link_to "here",
                      poly_reset_rankings_festival_url(@festival),
                      :method => :post,
                      :confirm => "Are you sure you want to throw away all your priority settings?" %>.)
</p>
<% else %>
<p>Here are all the films in the festival. (If you log in, you'll be able to set your
priorities for seeing each film. We'll then try to automatically schedule as many of
your preferred films as possible.)</p>
<% end %>

<table class="filmlist">
<% if logged_in? -%>
  <tr><td id="guide">(lower ... higher)</td><td>&nbsp;</td></tr>
<% end -%>
<%= render :partial => "film", :collection => @films.sort_by(&:sort_name), :locals => { :picks => @picks } %>
</table>

<script>

//var Priority=Class.create();
//Priority.prototype={
//  initialize: function(level) {
//    this.level = level;
//    // this.images = priorityImages;
//  }
//};

function toggle_all_screenings() {
  $$('.screenings label').each(function(label) {
    label.nextSibling.show();
  });
}

addLoadEvent(function() {
	$$('.screenings label').each(function(label) {
		label.onclick = function() { 
			Effect.toggle(label.nextSibling, 'appear', {duration:0.3}); 
		}
	});
  
//  $$('.priority').each(function(priority) {
//    priority.title = "hi";
//    priority.onmouseover =  {
//      // Start tracking mouse movement  
//    }
//    priority.onmouseleave = function() {
//      // Stop tracking mouse movement
//    }
//  });
});
</script>
